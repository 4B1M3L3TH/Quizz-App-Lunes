<!DOCTYPE html>
<html lang="es" class="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Preguntas preguntonas</title>
    <link rel="icon" href="examen.png" title="Icono" type="image/png" />
  <style>
    /* General Styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    :root {
      --bg-color: #f5f5f5;
      --card-bg: white;
      --text-color: #333;
      --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --border-color: #e5e7eb;
      --option-bg: #f3f4f6;
      --option-hover: #e5e7eb;
    }
    
    html.dark {
      --bg-color: #1a1a1a;
      --card-bg: #2a2a2a;
      --text-color: #f5f5f5;
      --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      --border-color: #444;
      --option-bg: #3a3a3a;
      --option-hover: #444;
    }
    
    body {
      background-color: var(--bg-color);
      padding: 20px;
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
    }
    
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: var(--text-color);
    }
    
    /* Dark Mode Toggle */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 100;
      background-color: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: var(--card-shadow);
    }
    
    .theme-toggle svg {
      width: 24px;
      height: 24px;
      fill: var(--text-color);
    }
    
    /* Card Styles */
    .card {
      background-color: var(--card-bg);
      border-radius: 8px;
      box-shadow: var(--card-shadow);
      margin-bottom: 20px;
      overflow: hidden;
      transition: background-color 0.3s;
    }
    
    .card-header {
      padding: 15px;
      font-weight: bold;
      font-size: 1.2rem;
    }
    
    .card-content {
      padding: 20px;
    }
    
    /* Team Setup */
    .setup-form {
      max-width: 500px;
      margin: 0 auto;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    .form-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 1rem;
      background-color: var(--card-bg);
      color: var(--text-color);
    }
    
    /* Teams Display */
    .teams-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .team-card {
      flex: 1;
      min-width: 250px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .team-card.selected {
      border: 3px solid #4c1d95;
    }
    
    .team-1 .card-header {
      background-color: #dbeafe;
      color: #1e40af;
    }
    
    .team-2 .card-header {
      background-color: #fee2e2;
      color: #b91c1c;
    }
    
    .team-3 .card-header {
      background-color: #d1fae5;
      color: #065f46;
    }
    
    .team-4 .card-header {
      background-color: #fef3c7;
      color: #92400e;
    }
    
    .team-score {
      font-size: 3rem;
      font-weight: bold;
      margin: 10px 0;
    }
    
    .team-status {
      margin-top: 10px;
      font-weight: 500;
      height: 24px;
    }
    
    .hand-raised {
      color: #059669;
    }
    
    .answering {
      color: #4f46e5;
    }
    
    /* Question Card */
    .question-card {
      margin-top: 30px;
    }
    
    .question-text {
      background-color: var(--option-bg);
      padding: 20px;
      border-radius: 6px;
      font-size: 1.2rem;
      text-align: center;
      margin-bottom: 20px;
    }
    
    /* Timer */
    .timer-container {
      margin: 15px 0;
      text-align: center;
    }
    
    .timer {
      font-size: 2rem;
      font-weight: bold;
      color: #4f46e5;
    }
    
    .timer.warning {
      color: #f59e0b;
    }
    
    .timer.danger {
      color: #ef4444;
    }
    
    /* Answer Options */
    .answer-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .answer-option {
      padding: 15px;
      background-color: var(--option-bg);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      cursor: pointer;
      text-align: center;
      font-weight: 500;
      transition: all 0.2s;
    }
    
    .answer-option:hover {
      background-color: var(--option-hover);
    }
    
    .answer-option.selected {
      background-color: #dbeafe;
      border-color: #93c5fd;
    }
    
    .answer-option.correct {
      background-color: #d1fae5;
      border-color: #34d399;
      color: #065f46;
    }
    
    .answer-option.incorrect {
      background-color: #fee2e2;
      border-color: #f87171;
      color: #b91c1c;
    }
    
    /* Buttons */
    .btn {
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      transition: background-color 0.2s;
    }
    
    .btn-primary {
      background-color: #4f46e5;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #4338ca;
    }
    
    .btn-outline {
      background-color: transparent;
      border: 1px solid #4f46e5;
      color: #4f46e5;
    }
    
    .btn-outline:hover {
      background-color: #f5f3ff;
    }
    
    .btn-success {
      background-color: #10b981;
      color: white;
    }
    
    .btn-success:hover {
      background-color: #059669;
    }
    
    .btn-danger {
      background-color: #ef4444;
      color: white;
    }
    
    .btn-danger:hover {
      background-color: #dc2626;
    }
    
    .btn-block {
      display: block;
      width: 100%;
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    /* Button Groups */
    .btn-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .btn-group .btn {
      flex: 1;
    }
    
    /* Controls */
    .controls {
      margin-top: 20px;
    }
    
    .control-section {
      margin-bottom: 20px;
    }
    
    .control-title {
      text-align: center;
      margin-bottom: 15px;
      font-weight: 500;
    }
    
    .center-btn {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
    
    /* Game Instructions */
    .game-instructions {
      text-align: center;
      margin-bottom: 15px;
      font-weight: 500;
      color: var(--text-color);
    }
    
    /* Game Summary */
    .game-summary {
      margin-top: 20px;
    }
    
    .summary-title {
      font-size: 1.5rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 20px;
      color: #4f46e5;
    }
    
    .winner-announcement {
      font-size: 1.8rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 30px;
      padding: 15px;
      border-radius: 8px;
    }
    
    .winner-team-1 {
      background-color: #dbeafe;
      color: #1e40af;
    }
    
    .winner-team-2 {
      background-color: #fee2e2;
      color: #b91c1c;
    }
    
    .winner-team-3 {
      background-color: #d1fae5;
      color: #065f46;
    }
    
    .winner-team-4 {
      background-color: #fef3c7;
      color: #92400e;
    }
    
    .winner-tie {
      background-color: var(--option-bg);
      color: var(--text-color);
    }
    
    .final-scores {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      margin-bottom: 30px;
      gap: 15px;
    }
    
    .final-score {
      text-align: center;
      padding: 15px;
      border-radius: 8px;
      min-width: 200px;
    }
    
    .final-score-team-1 {
      background-color: #dbeafe;
    }
    
    .final-score-team-2 {
      background-color: #fee2e2;
    }
    
    .final-score-team-3 {
      background-color: #d1fae5;
    }
    
    .final-score-team-4 {
      background-color: #fef3c7;
    }
    
    .final-score-name {
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 5px;
    }
    
    .final-score-points {
      font-size: 2rem;
      font-weight: bold;
    }
    
    .history-title {
      font-size: 1.3rem;
      font-weight: bold;
      text-align: center;
      margin: 20px 0;
    }
    
    .history-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .team-history {
      flex: 1;
      min-width: 300px;
    }
    
    .team-history-header {
      font-weight: bold;
      padding: 10px;
      border-radius: 6px 6px 0 0;
      text-align: center;
    }
    
    .team-1-header {
      background-color: #dbeafe;
      color: #1e40af;
    }
    
    .team-2-header {
      background-color: #fee2e2;
      color: #b91c1c;
    }
    
    .team-3-header {
      background-color: #d1fae5;
      color: #065f46;
    }
    
    .team-4-header {
      background-color: #fef3c7;
      color: #92400e;
    }
    
    .history-list {
      list-style-type: none;
      border: 1px solid var(--border-color);
      border-radius: 0 0 6px 6px;
    }
    
    .history-item {
      padding: 12px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
    }
    
    .history-item:last-child {
      border-bottom: none;
    }
    
    .history-question {
      flex: 1;
    }
    
    .history-result {
      margin-left: 10px;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 4px;
    }
    
    .history-correct {
      background-color: #d1fae5;
      color: #065f46;
    }
    
    .history-incorrect {
      background-color: #fee2e2;
      color: #b91c1c;
    }
    
    .history-no-answer {
      background-color: var(--option-bg);
      color: var(--text-color);
    }
    
    .restart-btn {
      margin-top: 30px;
    }
    
    /* Question Management */
    .question-management {
      margin-top: 20px;
    }
    
    .question-form {
      margin-bottom: 20px;
    }
    
    .question-list {
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      margin-top: 15px;
    }
    
    .question-item {
      padding: 10px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .question-item:last-child {
      border-bottom: none;
    }
    
    .question-text-preview {
      flex: 1;
      margin-right: 10px;
    }
    
    .team-management {
      margin-top: 20px;
    }
    
    .team-list {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }
    
    .team-item {
      flex: 1;
      min-width: 200px;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .teams-container {
        flex-direction: column;
      }
      
      .btn-group {
        flex-direction: column;
      }
      
      .answer-options {
        grid-template-columns: 1fr;
      }
      
      .final-scores {
        flex-direction: column;
        align-items: center;
        gap: 15px;
      }
      
      .history-container {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>
  <div class="theme-toggle" id="theme-toggle">
    <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="display: block;">
      <path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z" />
    </svg>
    <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="display: none;">
      <path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm-8 5a8 8 0 1 1 16 0 8 8 0 0 1-16 0zm8-9a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0V4a1 1 0 0 1 1-1zm0 16a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0v-1a1 1 0 0 1 1-1zm9-9a1 1 0 0 1-1 1h-1a1 1 0 1 1 0-2h1a1 1 0 0 1 1 1zM4 12a1 1 0 0 1-1 1H2a1 1 0 1 1 0-2h1a1 1 0 0 1 1 1zm14.95 6.36a1 1 0 0 1-1.41 0l-.71-.71a1 1 0 0 1 1.41-1.41l.71.71a1 1 0 0 1 0 1.41zm-11.9-11.9a1 1 0 0 1-1.41 0l-.71-.71a1 1 0 0 1 1.41-1.41l.71.71a1 1 0 0 1 0 1.41zm11.9 0a1 1 0 0 1 0-1.41l.71-.71a1 1 0 0 1 1.41 1.41l-.71.71a1 1 0 0 1-1.41 0zm-11.9 11.9a1 1 0 0 1 0 1.41l-.71.71a1 1 0 0 1-1.41-1.41l.71-.71a1 1 0 0 1 1.41 0z" />
    </svg>
  </div>
  
  <div class="container">
    <h1>Preguntas preguntonas, acerca de....</h1>
    
    <!-- Team Setup Form -->
    <div id="setup-section" class="card">
      <div class="card-header">Configuración de los Equipos</div>
      <div class="card-content">
        <div class="setup-form">
          <div id="teams-container">
            <div class="form-group">
              <label for="team1-name">Nombre del Equipo 1</label>
              <input type="text" id="team1-name" value="Equipo 1">
            </div>
            <div class="form-group">
              <label for="team2-name">Nombre del Equipo 2</label>
              <input type="text" id="team2-name" value="Equipo 2">
            </div>
          </div>
          
          <div class="center-btn" style="margin-bottom: 20px;">
            <button id="add-team" class="btn btn-outline">Agregar Equipo</button>
          </div>
          
          <div class="form-group">
            <label for="timer-seconds">Tiempo para responder (segundos)</label>
            <input type="number" id="timer-seconds" value="30" min="5" max="120">
          </div>
          
          <button id="manage-questions-btn" class="btn btn-outline btn-block" style="margin-bottom: 10px;">Administrar Preguntas</button>
          <button id="confirm-teams" class="btn btn-primary btn-block">Confirmar Equipos</button>
        </div>
      </div>
    </div>
    
    <!-- Question Management (Hidden initially) -->
    <div id="question-management" class="card" style="display: none;">
      <div class="card-header">Administrar Preguntas</div>
      <div class="card-content">
        <div class="question-form">
          <div class="form-group">
            <label for="new-question">Nueva Pregunta</label>
            <input type="text" id="new-question" placeholder="Escribe la pregunta">
          </div>
          
          <div class="form-group">
            <label>Opciones de Respuesta</label>
            <div id="options-container">
              <div class="form-group">
                <input type="text" class="option-input" placeholder="Opción 1">
              </div>
              <div class="form-group">
                <input type="text" class="option-input" placeholder="Opción 2">
              </div>
              <div class="form-group">
                <input type="text" class="option-input" placeholder="Opción 3">
              </div>
              <div class="form-group">
                <input type="text" class="option-input" placeholder="Opción 4">
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="correct-answer">Respuesta Correcta</label>
            <select id="correct-answer">
              <option value="0">Opción 1</option>
              <option value="1">Opción 2</option>
              <option value="2">Opción 3</option>
              <option value="3">Opción 4</option>
            </select>
          </div>
          
          <button id="add-question" class="btn btn-primary btn-block">Agregar Pregunta</button>
        </div>
        
        <div class="control-title">Preguntas Existentes</div>
        <div id="question-list" class="question-list">
          <!-- Questions will be added here dynamically -->
        </div>
        
        <div class="center-btn" style="margin-top: 20px;">
          <button id="back-to-setup" class="btn btn-outline">Volver a Configuración</button>
        </div>
      </div>
    </div>
    
    <!-- Game Section (Hidden initially) -->
    <div id="game-section" style="display: none;">
      <!-- Teams Display -->
      <div id="teams-display" class="teams-container">
        <!-- Teams will be added here dynamically -->
      </div>
      
      <!-- Question and Controls -->
      <div class="card question-card">
        <div class="card-header">Pregunta Actual</div>
        <div class="card-content">
          <!-- Start Game Button (shown initially) -->
          <div id="start-game-section">
            <button id="start-game" class="btn btn-primary btn-block">Iniciar Juego</button>
            <p style="text-align: center; margin-top: 15px;">Presiona el botón para comenzar el juego y mostrar la primera pregunta.</p>
          </div>
          
          <!-- Question Section (Hidden initially) -->
          <div id="question-section" style="display: none;">
            <!-- Timer -->
            <div class="timer-container">
              <div id="timer" class="timer">30</div>
            </div>
            
            <!-- Question Text -->
            <div id="current-question" class="question-text">
              La pregunta aparecerá aquí
            </div>
            
            <!-- Game Instructions -->
            <div id="game-instructions" class="game-instructions">
              Haz clic en el equipo que levantó la mano primero
            </div>
            
            <!-- Answer Options -->
            <div id="answer-options" class="answer-options" style="display: none;">
              <!-- Options will be added dynamically -->
            </div>
            
            <!-- Next Question Button -->
            <div class="center-btn">
              <button id="next-question" class="btn btn-outline">
                Siguiente Pregunta
              </button>
            </div>
          </div>
          
          <!-- Game Summary (Hidden initially) -->
          <div id="game-summary" style="display: none;">
            <div class="summary-title">Resumen del Juego</div>
            
            <!-- Winner Announcement -->
            <div id="winner-announcement" class="winner-announcement">
              <!-- Will be filled dynamically -->
            </div>
            
            <!-- Final Scores -->
            <div id="final-scores" class="final-scores">
              <!-- Will be filled dynamically -->
            </div>
            
            <!-- Answer History -->
            <div class="history-title">Historial de Respuestas</div>
            
            <div id="history-container" class="history-container">
              <!-- Will be filled dynamically -->
            </div>
            
            <!-- Restart Button -->
            <div class="center-btn restart-btn">
              <button id="restart-game" class="btn btn-primary">
                Jugar de Nuevo
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Quiz State
    const state = {
      teams: [
      {
        id: 1,
        name: "Equipo 1",
        score: 0,
        hasAnswered: false,
        isAnswering: false,
        history: [] // Array to store answer history
      },
      {
        id: 2,
        name: "Equipo 2",
        score: 0,
        hasAnswered: false,
        isAnswering: false,
        history: [] // Array to store answer history
      }],
      gameStarted: false,
      currentQuestion: null,
      currentQuestionIndex: 0,
      selectedTeam: null,
      selectedAnswer: null,
      incorrectAnswers: [], // Track incorrect answers
      timerSeconds: 30,
      timerInterval: null,
      timeRemaining: 30,
      waitingForTeamSelection: false,
      questions: [
      {
        question: "¿Cuál es el símbolo químico del elemento Carbono?",
        options: ["C", "Ca", "Co", "Cu"],
        correctAnswer: 0
      },
      {
        question: "¿Qué elemento tiene el número atómico 1?",
        options: ["Oxígeno", "Hidrógeno", "Nitrógeno", "Helio"],
        correctAnswer: 1
      },
      {
        question: "¿Cuál es el elemento con el símbolo Au?",
        options: ["Oro", "Plata", "Aluminio", "Cobre"],
        correctAnswer: 0
      },
      {
        question: "¿Qué elemento corresponde al número atómico 8?",
        options: ["Carbono", "Oxígeno", "Nitrógeno", "Azufre"],
        correctAnswer: 1
      },
      {
        question: "¿Cuál es el símbolo del elemento Sodio?",
        options: ["Na", "So", "S", "Si"],
        correctAnswer: 0
      },
      {
        question: "¿Qué elemento se identifica con el símbolo O?",
        options: ["Oxígeno", "Oro", "Osmio", "Óxido"],
        correctAnswer: 0
      },
      {
        question: "¿A qué grupo pertenecen los gases nobles?",
        options: ["Grupo 1", "Grupo 8", "Grupo 18", "Grupo 16"],
        correctAnswer: 2
      },
      {
        question: "¿Qué elemento tiene el símbolo Fe?",
        options: ["Fluor", "Hierro", "Francio", "Fósforo"],
        correctAnswer: 1
      },
      {
        question: "¿Cuál es el número atómico del elemento Nitrógeno (N)?",
        options: ["5", "6", "7", "8"],
        correctAnswer: 2
      },
      {
        question: "¿Qué elemento se representa con el símbolo Hg?",
        options: ["Helio", "Mercurio", "Hafnio", "Hidrógeno"],
        correctAnswer: 1
      }],
      availableQuestions: [],
      usedQuestions: [], // To keep track of questions that have been used
      nextTeamId: 3 // For adding new teams
    };
    
    // DOM Elements
    const elements = {
      setupSection: document.getElementById('setup-section'),
      gameSection: document.getElementById('game-section'),
      teamsContainer: document.getElementById('teams-container'),
      timerSecondsInput: document.getElementById('timer-seconds'),
      confirmTeamsBtn: document.getElementById('confirm-teams'),
      addTeamBtn: document.getElementById('add-team'),
      teamsDisplay: document.getElementById('teams-display'),
      startGameSection: document.getElementById('start-game-section'),
      startGameBtn: document.getElementById('start-game'),
      questionSection: document.getElementById('question-section'),
      currentQuestion: document.getElementById('current-question'),
      answerOptions: document.getElementById('answer-options'),
      gameInstructions: document.getElementById('game-instructions'),
      nextQuestionBtn: document.getElementById('next-question'),
      timer: document.getElementById('timer'),
      gameSummary: document.getElementById('game-summary'),
      winnerAnnouncement: document.getElementById('winner-announcement'),
      finalScores: document.getElementById('final-scores'),
      historyContainer: document.getElementById('history-container'),
      restartGameBtn: document.getElementById('restart-game'),
      themeToggle: document.getElementById('theme-toggle'),
      moonIcon: document.getElementById('moon-icon'),
      sunIcon: document.getElementById('sun-icon'),
      questionManagement: document.getElementById('question-management'),
      manageQuestionsBtn: document.getElementById('manage-questions-btn'),
      backToSetupBtn: document.getElementById('back-to-setup'),
      newQuestionInput: document.getElementById('new-question'),
      correctAnswerSelect: document.getElementById('correct-answer'),
      addQuestionBtn: document.getElementById('add-question'),
      questionList: document.getElementById('question-list')
    };
    
    // Initialize the game
    function init() {
      // Copy questions to available questions
      state.availableQuestions = [...state.questions];
      state.usedQuestions = [];
      
      // Reset team histories
      state.teams.forEach(team => {
        team.history = [];
        team.score = 0;
        team.hasAnswered = false;
        team.isAnswering = false;
      });
      
      // Set up event listeners
      elements.confirmTeamsBtn.addEventListener('click', setupTeams);
      elements.startGameBtn.addEventListener('click', startGame);
      elements.nextQuestionBtn.addEventListener('click', nextQuestion);
      elements.restartGameBtn.addEventListener('click', restartGame);
      elements.addTeamBtn.addEventListener('click', addTeamInput);
      elements.themeToggle.addEventListener('click', toggleTheme);
      elements.manageQuestionsBtn.addEventListener('click', showQuestionManagement);
      elements.backToSetupBtn.addEventListener('click', hideQuestionManagement);
      elements.addQuestionBtn.addEventListener('click', addQuestion);
      
      // Load questions into the question list
      updateQuestionList();
    }
    
    // Toggle dark/light theme
    function toggleTheme() {
      const html = document.documentElement;
      if (html.classList.contains('dark')) {
        html.classList.remove('dark');
        elements.moonIcon.style.display = 'block';
        elements.sunIcon.style.display = 'none';
      } else {
        html.classList.add('dark');
        elements.moonIcon.style.display = 'none';
        elements.sunIcon.style.display = 'block';
      }
    }
    
    // Show question management section
    function showQuestionManagement() {
      elements.setupSection.style.display = 'none';
      elements.questionManagement.style.display = 'block';
    }
    
    // Hide question management section
    function hideQuestionManagement() {
      elements.questionManagement.style.display = 'none';
      elements.setupSection.style.display = 'block';
    }
    
    // Add a new question
    function addQuestion() {
      const questionText = elements.newQuestionInput.value.trim();
      if (questionText === '') {
        alert('Por favor ingresa una pregunta');
        return;
      }
      
      const optionInputs = document.querySelectorAll('.option-input');
      const options = [];
      
      for (let i = 0; i < optionInputs.length; i++) {
        const optionText = optionInputs[i].value.trim();
        if (optionText === '') {
          alert(`Por favor completa la opción ${i + 1}`);
          return;
        }
        options.push(optionText);
      }
      
      const correctAnswer = parseInt(elements.correctAnswerSelect.value);
      
      // Add the new question
      state.questions.push({
        question: questionText,
        options: options,
        correctAnswer: correctAnswer
      });
      
      // Reset the form
      elements.newQuestionInput.value = '';
      optionInputs.forEach(input => {
        input.value = '';
      });
      
      // Update the question list
      updateQuestionList();
      
      // Update available questions
      state.availableQuestions = [...state.questions];
    }
    
    // Update the question list in the UI
    function updateQuestionList() {
      elements.questionList.innerHTML = '';
      
      state.questions.forEach((question, index) => {
        const questionItem = document.createElement('div');
        questionItem.className = 'question-item';
        
        const questionText = document.createElement('div');
        questionText.className = 'question-text-preview';
        questionText.textContent = question.question;
        
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'btn btn-danger';
        deleteBtn.textContent = 'Eliminar';
        deleteBtn.addEventListener('click', () => deleteQuestion(index));
        
        questionItem.appendChild(questionText);
        questionItem.appendChild(deleteBtn);
        
        elements.questionList.appendChild(questionItem);
      });
    }
    
    // Delete a question
    function deleteQuestion(index) {
      if (confirm('¿Estás seguro de que deseas eliminar esta pregunta?')) {
        state.questions.splice(index, 1);
        updateQuestionList();
        
        // Update available questions
        state.availableQuestions = [...state.questions];
      }
    }
    
    // Add a new team input field
    function addTeamInput() {
      if (state.teams.length >= 4) {
        alert('Máximo 4 equipos permitidos');
        return;
      }
      
      const teamId = state.nextTeamId;
      
      const formGroup = document.createElement('div');
      formGroup.className = 'form-group';
      
      const label = document.createElement('label');
      label.setAttribute('for', `team${teamId}-name`);
      label.textContent = `Nombre del Equipo ${teamId}`;
      
      const input = document.createElement('input');
      input.type = 'text';
      input.id = `team${teamId}-name`;
      input.value = `Equipo ${teamId}`;
      
      formGroup.appendChild(label);
      formGroup.appendChild(input);
      
      elements.teamsContainer.appendChild(formGroup);
      
      // Add team to state
      state.teams.push({
        id: teamId,
        name: `Equipo ${teamId}`,
        score: 0,
        hasAnswered: false,
        isAnswering: false,
        history: []
      });
      
      state.nextTeamId++;
    }
    
    // Set up team names and timer
    function setupTeams() {
      // Get team names from inputs
      for (let i = 0; i < state.teams.length; i++) {
        const teamInput = document.getElementById(`team${state.teams[i].id}-name`);
        if (teamInput) {
          const teamName = teamInput.value.trim();
          if (teamName === "") {
            alert(`Por favor ingresa un nombre para el Equipo ${state.teams[i].id}`);
            return;
          }
          state.teams[i].name = teamName;
        }
      }
      
      const timerSeconds = parseInt(elements.timerSecondsInput.value);
      
      if (isNaN(timerSeconds) || timerSeconds < 5 || timerSeconds > 120) {
        alert("Por favor ingresa un tiempo válido entre 5 y 120 segundos");
        return;
      }
      
      // Update state
      state.timerSeconds = timerSeconds;
      state.timeRemaining = timerSeconds;
      
      // Reset scores
      state.teams.forEach(team => {
        team.score = 0;
      });
      
      // Create team cards
      createTeamCards();
      
      // Show game section
      elements.setupSection.style.display = 'none';
      elements.gameSection.style.display = 'block';
    }
    
    // Create team cards in the game section
    function createTeamCards() {
      elements.teamsDisplay.innerHTML = '';
      
      state.teams.forEach(team => {
        const teamCard = document.createElement('div');
        teamCard.id = `team-${team.id}-card`;
        teamCard.className = `team-card team-${team.id} card`;
        teamCard.addEventListener('click', () => selectTeamToAnswer(team.id));
        
        const cardHeader = document.createElement('div');
        cardHeader.className = 'card-header';
        cardHeader.id = `team-${team.id}-header`;
        cardHeader.textContent = team.name;
        
        const cardContent = document.createElement('div');
        cardContent.className = 'card-content';
        
        const teamScore = document.createElement('div');
        teamScore.id = `team-${team.id}-score`;
        teamScore.className = 'team-score';
        teamScore.textContent = '0';
        
        const teamStatus = document.createElement('div');
        teamStatus.id = `team-${team.id}-status`;
        teamStatus.className = 'team-status';
        teamStatus.textContent = 'Esperando inicio del juego';
        
        cardContent.appendChild(teamScore);
        cardContent.appendChild(teamStatus);
        
        teamCard.appendChild(cardHeader);
        teamCard.appendChild(cardContent);
        
        elements.teamsDisplay.appendChild(teamCard);
      });
    }
    
    // Start the game
    function startGame() {
      state.gameStarted = true;
      
      // Update UI
      elements.startGameSection.style.display = 'none';
      elements.questionSection.style.display = 'block';
      elements.gameSummary.style.display = 'none';
      
      // Select first question
      selectRandomQuestion();
    }
    
    // Select a random question
    function selectRandomQuestion() {
      if (state.availableQuestions.length === 0) {
        // No more questions, show game summary
        showGameSummary();
        return;
      }
      
      const randomIndex = Math.floor(Math.random() * state.availableQuestions.length);
      state.currentQuestion = state.availableQuestions[randomIndex];
      state.currentQuestionIndex = state.questions.findIndex(q => q.question === state.currentQuestion.question);
      
      // Remove the selected question from available and add to used
      state.availableQuestions.splice(randomIndex, 1);
      state.usedQuestions.push(state.currentQuestion);
      
      // Update UI
      elements.currentQuestion.textContent = state.currentQuestion.question;
      
      // Clear and create answer options
      elements.answerOptions.innerHTML = '';
      state.currentQuestion.options.forEach((option, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'answer-option';
        optionElement.textContent = option;
        optionElement.dataset.index = index;
        optionElement.addEventListener('click', () => selectAnswer(index));
        elements.answerOptions.appendChild(optionElement);
      });
      
      // Reset round
      resetRound();
    }
    
    // Reset the current round
    function resetRound() {
      // Reset state
      state.teams.forEach(team => {
        team.hasAnswered = false;
        team.isAnswering = false;
      });
      
      state.selectedTeam = null;
      state.selectedAnswer = null;
      state.incorrectAnswers = [];
      state.waitingForTeamSelection = true;
      
      // Update UI
      state.teams.forEach(team => {
        const statusElement = document.getElementById(`team-${team.id}-status`);
        const cardElement = document.getElementById(`team-${team.id}-card`);
        
        if (statusElement) statusElement.textContent = "";
        if (cardElement) cardElement.classList.remove('selected');
      });
      
      // Show instructions, hide answer options
      elements.gameInstructions.style.display = 'block';
      elements.gameInstructions.textContent = 'Haz clic en el equipo que levantó la mano primero';
      elements.answerOptions.style.display = 'none';
      
      // Reset answer options
      const answerOptions = document.querySelectorAll('.answer-option');
      answerOptions.forEach(option => {
        option.classList.remove('selected');
        option.classList.remove('correct');
        option.classList.remove('incorrect');
        option.style.pointerEvents = 'auto';
      });
      
      // Reset timer
      stopTimer();
      state.timeRemaining = state.timerSeconds;
      elements.timer.textContent = state.timeRemaining;
      elements.timer.className = 'timer';
    }
    
    // Select team to answer (when clicking on team card)
    function selectTeamToAnswer(teamId) {
      // Only allow selection if waiting for team selection
      if (!state.waitingForTeamSelection) return;
      
      // Find the team
      const team = state.teams.find(t => t.id === teamId);
      if (!team) return;
      
      // If team has already answered, don't allow selection
      if (team.hasAnswered) return;
      
      state.selectedTeam = teamId;
      state.waitingForTeamSelection = false;
      
      // Update UI for all teams
      state.teams.forEach(t => {
        const statusElement = document.getElementById(`team-${t.id}-status`);
        const cardElement = document.getElementById(`team-${t.id}-card`);
        
        if (t.id === teamId) {
          t.isAnswering = true;
          if (cardElement) cardElement.classList.add('selected');
          if (statusElement) {
            statusElement.textContent = "Respondiendo...";
            statusElement.classList.add('answering');
          }
        } else {
          t.isAnswering = false;
          if (cardElement) cardElement.classList.remove('selected');
          if (statusElement) statusElement.classList.remove('answering');
        }
      });
      
      // Show answer options
      elements.gameInstructions.textContent = `${team.name} está respondiendo`;
      elements.answerOptions.style.display = 'grid';
      
      // Start timer
      startTimer();
    }
    
    // Select an answer
    function selectAnswer(index) {
      if (!state.selectedTeam) return;
      
      state.selectedAnswer = index;
      
      // Find the selected team
      const team = state.teams.find(t => t.id === state.selectedTeam);
      if (!team) return;
      
      // Update UI
      const answerOptions = document.querySelectorAll('.answer-option');
      answerOptions.forEach(option => {
        option.classList.remove('selected');
      });
      
      // Check if the answer is correct
      if (index === state.currentQuestion.correctAnswer) {
        // Mark as correct (green)
        answerOptions[index].classList.add('correct');
        handleCorrectAnswer(team);
      } else {
        // Mark only the selected answer as incorrect (red)
        answerOptions[index].classList.add('incorrect');
        
        // Add to incorrect answers
        state.incorrectAnswers.push(index);
        
        // Mark the team as having answered
        team.hasAnswered = true;
        team.isAnswering = false;
        
        handleIncorrectAnswer(team);
      }
    }
    
    // Handle correct answer
    function handleCorrectAnswer(team) {
      // Stop timer
      stopTimer();
      
      // Award points
      team.score += 10;
      const scoreElement = document.getElementById(`team-${team.id}-score`);
      const statusElement = document.getElementById(`team-${team.id}-status`);
      
      if (scoreElement) scoreElement.textContent = team.score;
      if (statusElement) statusElement.textContent = "¡Respuesta correcta!";
      
      // Add to history
      team.history.push({
        question: state.currentQuestion.question,
        answer: state.currentQuestion.options[state.currentQuestion.correctAnswer],
        correct: true
      });
      
      // Disable answer options
      const answerOptions = document.querySelectorAll('.answer-option');
      answerOptions.forEach(option => {
        option.style.pointerEvents = 'none';
      });
      
      // Update instructions
      elements.gameInstructions.textContent = "¡Respuesta correcta!";
      
      // Wait 2 seconds before moving to next question
      setTimeout(() => {
        selectRandomQuestion();
      }, 2000);
    }
    
    // Handle incorrect answer
    function handleIncorrectAnswer(team) {
      // Stop timer
      stopTimer();
      
      // Update UI for incorrect answer
      const statusElement = document.getElementById(`team-${team.id}-status`);
      if (statusElement) {
        statusElement.textContent = "Respuesta incorrecta";
        statusElement.classList.remove('answering');
      }
      
      // Add to history
      team.history.push({
        question: state.currentQuestion.question,
        answer: state.currentQuestion.options[state.selectedAnswer],
        correct: false
      });
      
      // Check if all teams have answered incorrectly
      const allTeamsAnswered = state.teams.every(t => t.hasAnswered);
      
      if (allTeamsAnswered) {
        // All teams have answered incorrectly, show the correct answer
        const answerOptions = document.querySelectorAll('.answer-option');
        answerOptions[state.currentQuestion.correctAnswer].classList.add('correct');
        
        // Disable answer options
        answerOptions.forEach(option => {
          option.style.pointerEvents = 'none';
        });
        
        // Update instructions
        elements.gameInstructions.textContent = "Todos los equipos respondieron incorrectamente";
        
        // Wait 2 seconds before moving to next question
        setTimeout(() => {
          selectRandomQuestion();
        }, 2000);
      } else {
        // Give the opportunity to another team
        // Find teams that haven't answered yet
        const availableTeams = state.teams.filter(t => !t.hasAnswered);
        
        if (availableTeams.length === 1) {
          // If only one team left, automatically select it
          const nextTeam = availableTeams[0];
          
          // Update instructions
          elements.gameInstructions.textContent = `Turno de ${nextTeam.name}`;
          
          // Reset for other team selection
          state.waitingForTeamSelection = true;
          
          // Give a short pause before auto-selecting the other team
          setTimeout(() => {
            selectTeamToAnswer(nextTeam.id);
          }, 1000);
        } else {
          // Multiple teams available, let user select
          elements.gameInstructions.textContent = "Selecciona el siguiente equipo que levantó la mano";
          state.waitingForTeamSelection = true;
        }
      }
    }
    
    // Start the timer
    function startTimer() {
      // Reset timer
      stopTimer();
      state.timeRemaining = state.timerSeconds;
      elements.timer.textContent = state.timeRemaining;
      elements.timer.className = 'timer';
      
      // Start interval
      state.timerInterval = setInterval(() => {
        state.timeRemaining--;
        elements.timer.textContent = state.timeRemaining;
        
        // Add warning classes
        if (state.timeRemaining <= 10) {
          elements.timer.classList.add('warning');
        }
        if (state.timeRemaining <= 5) {
          elements.timer.classList.remove('warning');
          elements.timer.classList.add('danger');
        }
        
        // Time's up
        if (state.timeRemaining <= 0) {
          stopTimer();
          handleTimeUp();
        }
      }, 1000);
    }
    
    // Stop the timer
    function stopTimer() {
      clearInterval(state.timerInterval);
    }
    
    // Handle time up
    function handleTimeUp() {
      // Find the selected team
      const team = state.teams.find(t => t.id === state.selectedTeam);
      if (!team) return;
      
      const statusElement = document.getElementById(`team-${team.id}-status`);
      if (statusElement) {
        statusElement.textContent = "¡Tiempo agotado!";
        statusElement.classList.remove('answering');
      }
      
      team.hasAnswered = true;
      team.isAnswering = false;
      
      // Add to history
      team.history.push({
        question: state.currentQuestion.question,
        answer: "Sin respuesta (tiempo agotado)",
        correct: false
      });
      
      // Check if all teams have had a chance
      const allTeamsAnswered = state.teams.every(t => t.hasAnswered);
      
      if (allTeamsAnswered) {
        // Show the correct answer
        const answerOptions = document.querySelectorAll('.answer-option');
        answerOptions[state.currentQuestion.correctAnswer].classList.add('correct');
        
        // Update instructions
        elements.gameInstructions.textContent = "Todos los equipos se quedaron sin tiempo";
        
        // Wait 2 seconds before moving to next question
        setTimeout(() => {
          selectRandomQuestion();
        }, 2000);
      } else {
        // Find teams that haven't answered yet
        const availableTeams = state.teams.filter(t => !t.hasAnswered);
        
        if (availableTeams.length === 1) {
          // If only one team left, automatically select it
          const nextTeam = availableTeams[0];
          
          // Update instructions
          elements.gameInstructions.textContent = `Turno de ${nextTeam.name}`;
          
          // Reset for other team selection
          state.waitingForTeamSelection = true;
          
          // Give a short pause before auto-selecting the other team
          setTimeout(() => {
            selectTeamToAnswer(nextTeam.id);
          }, 1000);
        } else {
          // Multiple teams available, let user select
          elements.gameInstructions.textContent = "Selecciona el siguiente equipo que levantó la mano";
          state.waitingForTeamSelection = true;
        }
      }
    }
    
    // Move to next question without awarding points
    function nextQuestion() {
      stopTimer();
      
      // Add to history for teams that didn't answer
      state.teams.forEach(team => {
        if (!team.hasAnswered && !team.isAnswering) {
          team.history.push({
            question: state.currentQuestion.question,
            answer: "Sin respuesta",
            correct: false
          });
        }
      });
      
      selectRandomQuestion();
    }
    
    // Show game summary
    function showGameSummary() {
      // Hide question section
      elements.questionSection.style.display = 'none';
      
      // Show summary section
      elements.gameSummary.style.display = 'block';
      
      // Clear previous summary
      elements.finalScores.innerHTML = '';
      elements.historyContainer.innerHTML = '';
      
      // Find the winner
      let maxScore = -1;
      let winners = [];
      
      state.teams.forEach(team => {
        if (team.score > maxScore) {
          maxScore = team.score;
          winners = [team];
        } else if (team.score === maxScore) {
          winners.push(team);
        }
      });
      
      // Determine winner message
      let winnerMessage = '';
      let winnerClass = '';
      
      if (winners.length === 1) {
        winnerMessage = `¡${winners[0].name} ha ganado!`;
        winnerClass = `winner-team-${winners[0].id}`;
      } else {
        winnerMessage = '¡Empate!';
        winnerClass = 'winner-tie';
      }
      
      elements.winnerAnnouncement.textContent = winnerMessage;
      elements.winnerAnnouncement.className = `winner-announcement ${winnerClass}`;
      
      // Create final scores
      state.teams.forEach(team => {
        const finalScore = document.createElement('div');
        finalScore.className = `final-score final-score-team-${team.id}`;
        
        const finalScoreName = document.createElement('div');
        finalScoreName.className = 'final-score-name';
        finalScoreName.textContent = team.name;
        
        const finalScorePoints = document.createElement('div');
        finalScorePoints.className = 'final-score-points';
        finalScorePoints.textContent = team.score;
        
        finalScore.appendChild(finalScoreName);
        finalScore.appendChild(finalScorePoints);
        
        elements.finalScores.appendChild(finalScore);
      });
      
      // Generate history lists
      state.teams.forEach(team => {
        const teamHistory = document.createElement('div');
        teamHistory.className = 'team-history';
        
        const historyHeader = document.createElement('div');
        historyHeader.className = `team-history-header team-${team.id}-header`;
        historyHeader.textContent = team.name;
        
        const historyList = document.createElement('ul');
        historyList.className = 'history-list';
        
        // Generate history items
        if (team.history.length === 0) {
          const emptyItem = document.createElement('li');
          emptyItem.className = 'history-item';
          emptyItem.textContent = 'No hay respuestas registradas';
          historyList.appendChild(emptyItem);
        } else {
          team.history.forEach(item => {
            const historyItem = document.createElement('li');
            historyItem.className = 'history-item';
            
            const questionSpan = document.createElement('span');
            questionSpan.className = 'history-question';
            questionSpan.textContent = item.question;
            
            const resultSpan = document.createElement('span');
            if (item.correct) {
              resultSpan.className = 'history-result history-correct';
              resultSpan.textContent = '✓';
            } else {
              resultSpan.className = 'history-result history-incorrect';
              resultSpan.textContent = '✗';
            }
            
            historyItem.appendChild(questionSpan);
            historyItem.appendChild(resultSpan);
            
            // Add tooltip with the answer
            historyItem.title = `Respuesta: ${item.answer}`;
            
            historyList.appendChild(historyItem);
          });
        }
        
        teamHistory.appendChild(historyHeader);
        teamHistory.appendChild(historyList);
        
        elements.historyContainer.appendChild(teamHistory);
      });
    }
    
    // Restart game
    function restartGame() {
      // Reset scores
      state.teams.forEach(team => {
        team.score = 0;
        team.history = [];
      });
      
      // Reset questions
      state.availableQuestions = [...state.questions];
      state.usedQuestions = [];
      
      // Update UI
      state.teams.forEach(team => {
        const scoreElement = document.getElementById(`team-${team.id}-score`);
        if (scoreElement) scoreElement.textContent = "0";
      });
      
      // Start game again
      startGame();
    }
    
    // Initialize the game when the page loads
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>

</html>